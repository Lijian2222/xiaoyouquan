"use strict";const e=require("../common/vendor.js"),t=require("./environment.js").environmentStore().currentUrl,a=e.defineStore("post",(()=>{const a=e.ref([]),d=e.ref([]),o=e.ref([]);function u(e){const t=new Date(e.publishTime),a=`${(t.getMonth()+1).toString().padStart(2,0)}-${t.getDate().toString().padStart(2,"0")} ${t.getHours().toString().padStart(2,"0")}:${t.getMinutes().toString().padStart(2,"0")}:${t.getSeconds().toString().padStart(2,"0")}`;e.publishTime=a}return{list1:a,list2:d,list3:o,getList1:async function(d){let o=await e.index.request({url:t+"/post/query",method:"post",data:{isDeleted:0,pageIndex:d,pageSize:5}});o.data.data.forEach(u),a.value=[...a.value,...o.data.data]},getList2:async function(a){let o=await e.index.request({url:t+"/post/query",method:"post",data:{isDeleted:0,campus:"哈尔滨工业大学",pageIndex:a,pageSize:5}});o.data.data.forEach(u),d.value=[...d.value,...o.data.data]},getList3:async function(a){let d=await e.index.request({url:t+"/post/query",method:"post",data:{isDeleted:0,currentUserId:1,pageIndex:a,pageSize:5}});d.data.data.forEach(u),o.value=[...o.value,...d.data.data]},notInteresting:function(e){a.value=a.value.filter((t=>t.id!=e)),d.value=d.value.filter((t=>t.id!=e)),o.value=o.value.filter((t=>t.id!=e))},formatNumber:function(e){return e>=0&&e<1e3?e.toString():e>=1e3&&e<1e4?(e/1e3).toFixed(1)+"k":e>=1e4?(e/1e4).toFixed(1)+"w":"Number out of range"},requestGood:function(a){return new Promise(((d,o)=>{e.index.request({url:t+"/postGood/query",method:"POST",data:{postId:a,isDeleted:0,userId:1},success:e=>{1==e.data.data?d(!0):d(!1)},fail:e=>{o(e)}})}))},addGoodNums:function(e){a.value.map(((t,a)=>(t.id==e&&t.goodNums++,t))),d.value.map(((t,a)=>(t.id==e&&t.goodNums++,t))),o.value.map(((t,a)=>(t.id==e&&t.goodNums++,t)))},subGoodNums:function(e){a.value.map(((t,a)=>(t.id==e&&t.goodNums--,t))),d.value.map(((t,a)=>(t.id==e&&t.goodNums--,t))),o.value.map(((t,a)=>(t.id==e&&t.goodNums--,t)))},addView:function(u){e.index.request({url:t+"/post/addViewNums",method:"GET",data:{postId:u}}),a.value.map(((e,t)=>(e.id==u&&e.viewNums++,e))),d.value.map(((e,t)=>(e.id==u&&e.viewNums++,e))),o.value.map(((e,t)=>(e.id==u&&e.viewNums++,e)))},handleTime:u}}));exports.postStore=a;
